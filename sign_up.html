<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Join</title>
    <link rel="icon" type="image/x-icon" href="./assets/img/logo_coloured.svg">
    <link rel="stylesheet" href="./css/side_menu.css">
    <link rel="stylesheet" href="./css/font.css">
    <link rel="stylesheet" href="./css/style.css">
    <link rel="stylesheet" href="./css/login-signup.css">
    <script src="./js/signupdatabase.js"></script>
    <script src="./js/signup.js"></script>
    <script src="./js/contactsfirebase.js"></script>
    <style> .error-message {
        color: red;
        font-size: 0.9em;
        display: none;
    }
    .inputfield.error {
        border: 2px solid red;
    }</style>
</head>
<body>
    <img class="logo-end" src="imgs/join_logo_dark.png" alt="join-logo">
    <section class="container-login-signup dflex-c-c">
        <div class="signup-mask dflex-c-c column">
            <div class="dflex-c-c column">
                <a href="./index.html" class="arrow-back">
                    <img src="./assets/img/icon_back.svg" alt="arrow-left">
                </a>
                <h1>Sign up</h1>
                <div class="text-line"></div>
            </div>


            <form onsubmit="return handleSignUp(event)" class="input-container dflex-c-c column">
                <input id="inputSignUpName" class="inputfield" type="text" placeholder="Name" required>
                <div id="inputSignUpNameError" class="error-message">Please enter a valid name (letters and spaces only).</div>
            
                <input id="inputSignUpMail" class="inputfield" type="email" placeholder="Email" required>
                <div id="inputSignUpMailError" class="error-message">Please enter a valid email (e.g., example@domain.com).</div>
            
                <input id="inputSignUpPassword1" class="inputfield" type="password" placeholder="Password" required>
                <div id="inputSignUpPassword1Error" class="error-message">Password must be at least 6 characters, and contain at least one uppercase letter, one lowercase letter, and one number.</div>
            
                <input id="inputSignUpPassword2" class="inputfield" type="password" placeholder="Confirm Password" required>
                <div id="inputSignUpPassword2Error" class="error-message">Passwords do not match.</div>
            
                <div class="checkbox-signup">
                    <input id="checkboxAccept" type="checkbox" name="remember-me" class="cp" required>
                    <span>I accept the <a href="./privacy-police.html">Privacy policy</a></span>
                </div>
                <button type="submit" class="btn-small cp">Sign up</button>
            </form>
        <!--<form onsubmit="return handleSignUp(event)" class="input-container dflex-c-c column">
            <input id="inputSignUpName" class="inputfield" type="text" placeholder="Name" required>
            <input id="inputSignUpMail" class="inputfield" type="email" placeholder="Email" required>
            <div id="inputSignUpMailError" class="error-message">Please enter a valid email (e.g., example@domain.com).</div>
            <input id="inputSignUpPassword1" class="inputfield" type="password" placeholder="Password" required>
            <input id="inputSignUpPassword2" class="inputfield" type="password" placeholder="Confirm Password" required>
            <div id="passwordIncorrect" class="d-none"></div>
            <div class="checkbox-signup">
                <input id="checkboxAccept" type="checkbox" name="remember-me" class="cp" required>
                <span>I accept the <a href="./privacy-police.html">Privacy policy</a></span>
            </div>
            <button type="submit" class="btn-small cp">Sign up</button>
        </form>-->
            
        </div>
        <div id="bgSignupSuccesfully" class="d-none dflex-c-c">
            <div class="btn-signup-succesfully dflex-c-c">
                You signed up successfully!
            </div>
        </div>
    </section>
    <section class="login-footer dflex-c-c">
        <a href="./privacy-police.html">Privacy Policy</a>
        <a href="./legal_notice.html">Legal Notice</a>
    </section>

    <script>

     // E-Mail, Name und Passwort Validierung
     document.getElementById('inputSignUpMail').addEventListener('input', validateEmailField);
    document.getElementById('inputSignUpMail').addEventListener('blur', validateEmailField);
    document.getElementById('inputSignUpName').addEventListener('input', validateNameField);
    document.getElementById('inputSignUpName').addEventListener('blur', validateNameField);
    document.getElementById('inputSignUpPassword1').addEventListener('input', validatePasswordField);
    document.getElementById('inputSignUpPassword1').addEventListener('blur', validatePasswordField);
    document.getElementById('inputSignUpPassword2').addEventListener('input', validateConfirmPasswordField);
    document.getElementById('inputSignUpPassword2').addEventListener('blur', validateConfirmPasswordField);

    // Funktion für E-Mail Validierung
    function validateEmailField() {
        const emailInput = document.getElementById('inputSignUpMail');
        const errorMessage = document.getElementById('inputSignUpMailError');
        const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;

        if (emailInput.value.trim() === "" || !emailPattern.test(emailInput.value)) {
            emailInput.classList.add('error');
            errorMessage.style.display = 'block';
        } else {
            emailInput.classList.remove('error');
            errorMessage.style.display = 'none';
        }
    }

    // Funktion für Name Validierung
    function validateNameField() {
        const nameInput = document.getElementById('inputSignUpName');
        const errorMessage = document.getElementById('inputSignUpNameError');
        // Nur Buchstaben und Leerzeichen sind erlaubt (keine Zahlen oder Sonderzeichen)
        const namePattern = /^[A-Za-z\s]+$/;

        if (nameInput.value.trim() === "" || !namePattern.test(nameInput.value)) {
            nameInput.classList.add('error');
            errorMessage.style.display = 'block';
        } else {
            nameInput.classList.remove('error');
            errorMessage.style.display = 'none';
        }
    }

    // Funktion für Passwort Validierung
    function validatePasswordField() {
        const passwordInput = document.getElementById('inputSignUpPassword1');
        const errorMessage = document.getElementById('inputSignUpPassword1Error');
        const passwordPattern = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d).{6,}$/; // Mindestens 6 Zeichen, ein Großbuchstabe, ein Kleinbuchstabe, eine Zahl

        if (passwordInput.value.trim() === "" || !passwordPattern.test(passwordInput.value)) {
            passwordInput.classList.add('error');
            errorMessage.style.display = 'block';
        } else {
            passwordInput.classList.remove('error');
            errorMessage.style.display = 'none';
        }
    }

    // Funktion für Passwort Bestätigung Validierung
    function validateConfirmPasswordField() {
        const passwordInput = document.getElementById('inputSignUpPassword1');
        const confirmPasswordInput = document.getElementById('inputSignUpPassword2');
        const errorMessage = document.getElementById('inputSignUpPassword2Error');

        if (confirmPasswordInput.value.trim() !== passwordInput.value.trim()) {
            confirmPasswordInput.classList.add('error');
            errorMessage.style.display = 'block';
        } else {
            confirmPasswordInput.classList.remove('error');
            errorMessage.style.display = 'none';
        }
    }

    // Hauptanmeldefunktion
    async function handleSignUp(event) {
        event.preventDefault(); // Verhindert die Formularabsendung

        // Überprüfen der E-Mail, des Namens und der Passwörter erneut bei der Anmeldung
        const emailInput = document.getElementById('inputSignUpMail');
        const emailErrorMessage = document.getElementById('inputSignUpMailError');
        const nameInput = document.getElementById('inputSignUpName');
        const nameErrorMessage = document.getElementById('inputSignUpNameError');
        const passwordInput = document.getElementById('inputSignUpPassword1');
        const passwordErrorMessage = document.getElementById('inputSignUpPassword1Error');
        const confirmPasswordInput = document.getElementById('inputSignUpPassword2');
        const confirmPasswordErrorMessage = document.getElementById('inputSignUpPassword2Error');

        const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        const namePattern = /^[A-Za-z\s]+$/;
        const passwordPattern = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d).{6,}$/; // Mindestens 6 Zeichen, ein Großbuchstabe, ein Kleinbuchstabe, eine Zahl

        // Überprüfen der E-Mail
        if (emailInput.value.trim() === "" || !emailPattern.test(emailInput.value)) {
            emailInput.classList.add('error');
            emailErrorMessage.style.display = 'block';
            return false; // Verhindert das Absenden des Formulars, wenn die E-Mail ungültig ist
        }

        // Überprüfen des Namens
        if (nameInput.value.trim() === "" || !namePattern.test(nameInput.value)) {
            nameInput.classList.add('error');
            nameErrorMessage.style.display = 'block';
            return false; // Verhindert das Absenden des Formulars, wenn der Name ungültig ist
        }

        // Überprüfen des Passworts
        if (passwordInput.value.trim() === "" || !passwordPattern.test(passwordInput.value)) {
            passwordInput.classList.add('error');
            passwordErrorMessage.style.display = 'block';
            return false; // Verhindert das Absenden des Formulars, wenn das Passwort ungültig ist
        }

        // Überprüfen der Passwortbestätigung
        if (confirmPasswordInput.value.trim() !== passwordInput.value.trim()) {
            confirmPasswordInput.classList.add('error');
            confirmPasswordErrorMessage.style.display = 'block';
            return false; // Verhindert das Absenden des Formulars, wenn die Passwörter nicht übereinstimmen
        }

        // Validierung erfolgreich, Anmeldedaten weiterverarbeiten...
        alert('Sign-up successful!');
        return true;
    }
    </script>

</body>
</html>